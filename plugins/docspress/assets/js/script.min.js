!function(e){function n(t){if(s[t])return s[t].exports;var o=s[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,n),o.l=!0,o.exports}var s={};n.m=e,n.c=s,n.d=function(e,s,t){n.o(e,s)||Object.defineProperty(e,s,{configurable:!1,enumerable:!0,get:t})},n.n=function(e){var s=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(s,"a",s),s},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=0)}([function(e,n,s){e.exports=s(1)},function(e,n){function s(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var t=function(){function e(e,n){for(var s=0;s<n.length;s++){var t=n[s];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(n,s,t){return s&&e(n.prototype,s),t&&e(n,t),n}}(),o=window.jQuery,a=function(){function e(){s(this,e);var n=this;n.cache={},n.pendingAjax=!1,n.xhrAjaxSearch=!1,n.$body=o("body"),n.$window=o(window),n.$document=o(document),n.$preloader=o('<div class="docspress-preloader"><span><span></span></span></div>'),n.$singleAjax=o(".docspress-single-ajax"),n.initSearch(),n.initAnchors(),n.initFeedbacks(),n.initAjax()}return t(e,[{key:"stripHash",value:function(e){return e.replace(/#.*/,"")}},{key:"initSearch",value:function(){var e=this,n=!1;e.$document.on("submit",".docspress-search-form",function(n){n.preventDefault(),e.prepareSearchResults(o(this))}),e.$document.on("input",".docspress-search-form",function(s){var t=this;s.preventDefault(),clearTimeout(n),n=setTimeout(function(){e.prepareSearchResults(o(t))},500)})}},{key:"prepareSearchResults",value:function(e){var n=this;if(n.xhrAjaxSearch&&n.xhrAjaxSearch.abort(),!e.find(".docspress-search-field").val())return void e.next(".docspress-search-form-result").html("");n.xhrAjaxSearch=o.ajax({type:"GET",url:e.attr("action"),data:e.serialize(),success:function(s){var t=o(s),a=t.find(".docspress-search-list").get(0).outerHTML;e.next(".docspress-search-form-result").html(a),n.xhrAjaxSearch=!1},error:function(e){console.log(e),n.xhrAjaxSearch=!1}})}},{key:"initAnchors",value:function(){var e=!!window.AnchorJS&&new window.AnchorJS;e&&(e.options={placement:"right",visible:"hover",icon:"#"},e.add(".docspress-single-content .entry-content h2, .docspress-single-content .entry-content h3, .docspress-single-content .entry-content h4"))}},{key:"initFeedbacks",value:function(){var e=this;e.$body.on("click",".docspress-single-feedback a",function(n){e.onFeedbackClick(n,o(this))}),e.$body.on("submit",".docspress-single-feedback + .docspress-single-feedback-suggestion",function(n){e.onFeedbackSuggestionSend(n,o(this))})}},{key:"initAjax",value:function(){var e=this;e.$singleAjax.length&&(e.setCache(window.location.href,{href:window.location.href,title:document.title,doc:e.$singleAjax.html(),html:document.documentElement.outerHTML}),e.$singleAjax.on("click",".docspress-nav-list a, .docspress-single-breadcrumbs a, .docspress-single-articles a, .docspress-single-adjacent-nav a, .docspress-search-form-result a",function(n){e.onDocLinksClick(n)}),e.$window.on("popstate",function(n){e.renderDoc(n.target.location.href)}))}},{key:"onFeedbackClick",value:function(e,n){e.preventDefault();var s=this;if(!s.pendingAjax){s.pendingAjax=!0;var t=n.closest(".docspress-single-feedback").addClass("docspress-single-feedback-loading"),a=n.closest(".docspress-single-content").find(".docspress-single-feedback-suggestion"),i=n.data("type"),r={post_id:n.data("id"),type:i,action:"docspress_ajax_feedback",_wpnonce:window.docspress_vars.nonce};t.append(s.$preloader.clone()),o.post(window.docspress_vars.ajaxurl,r,function(e){t.html("<div>"+e.data+"</div>"),e.success&&a.length&&(a.show(),a.append('<input type="hidden" name="feedback_type" value="'+i+'">')),t.removeClass("docspress-single-feedback-loading"),s.pendingAjax=!1})}}},{key:"onFeedbackSuggestionSend",value:function(e,n){e.preventDefault();var s=this;if(!s.pendingAjax){s.pendingAjax=!0;var t=n.closest(".docspress-single-feedback-suggestion").addClass("docspress-single-feedback-suggestion-loading"),a=n.find("button"),i=n.serializeArray().reduce(function(e,n){return e[n.name]=n.value,e},{}),r={post_id:i.id,from:i.from,suggestion:i.suggestion,feedback_type:i.feedback_type,action:"docspress_ajax_feedback_suggestion",_wpnonce:window.docspress_vars.nonce};t.append(s.$preloader.clone()),a.prop("disabled","disabled"),o.post(window.docspress_vars.ajaxurl,r,function(e){t.html("<div>"+e.data+"</div>").removeClass("docspress-single-feedback-suggestion-loading"),s.pendingAjax=!1})}}},{key:"setCache",value:function(e,n){e=e||!1,n=n||!1,e&&n&&!this.cache[e]&&(this.cache[e]=n)}},{key:"getCache",value:function(e){return!(!(e=e||!1)||!this.cache[e])&&this.cache[e]}},{key:"renderDoc",value:function(e){var n=this.getCache(e);this.$singleAjax.html(n.doc),o("title").text(n.title),o(".wp-admin-bar-edit .ab-item").attr("href",e);var s=o(".docspress-single")[0].getBoundingClientRect().top;s<0&&this.$document.scrollTop(this.$document.scrollTop()+s),this.initAnchors(),this.$document.trigger("docspress_ajax_loaded",n)}},{key:"onDocLinksClick",value:function(e){var n=e.currentTarget;e.which>1||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||window.location.protocol===n.protocol&&window.location.hostname===n.hostname&&(n.href.indexOf("#")>-1&&this.stripHash(n.href)===this.stripHash(window.location.href)||"file:"!==window.location.protocol&&(e.isDefaultPrevented()||(e.preventDefault(),this.loadDocPage(n.href))))}},{key:"loadDocPage",value:function(e){var n=this;if((e=e||!1)&&n.stripHash(e)!==n.stripHash(window.location.href)){var s=n.getCache(e);if(s)return n.renderDoc(e),void window.history.pushState(null,s.title,e);n.xhr&&n.xhr.abort&&(n.xhr.abort(),n.xhr={});var t=n.$singleAjax.addClass("docspress-single-ajax-loading");t.find(".docspress-single-content").append(n.$preloader.clone()),n.xhr=o.ajax({url:e,success:function(s){if(!s)return void(window.location=e);var a=o("<div>").html(s),i=a.find("title:eq(0)").text()||document.title,r=a.find(".docspress-single-ajax").html();if(!r)return void(window.location=e);n.setCache(e,{href:e,title:i,doc:r,html:s}),n.renderDoc(e),window.history.pushState(null,i,e),a.remove(),a=null,t.removeClass("docspress-single-ajax-loading")},error:function(n){0!==n.status?console.log("error",n):window.location=e,t.removeClass("docspress-single-ajax-loading")}})}}}]),e}();o(function(){new a})}]);